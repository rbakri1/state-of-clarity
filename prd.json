{
  "project": "State of Clarity",
  "branchName": "ralph/accountability-tracker-integration",
  "description": "Accountability Tracker Integration & Polish - Navigation updates, E2E testing, regression tests, performance validation, and developer documentation. PRD 6 of 6 (see tasks/prd-accountability-tracker-overview.md).",
  "userStories": [
    {
      "id": "US-001",
      "title": "Add Accountability navigation link to header",
      "description": "As a user, I want to see Accountability in the main navigation.",
      "acceptanceCriteria": [
        "Add 'Accountability' link to desktop header between Explore and Credits",
        "Link navigates to /accountability",
        "Current page indicator highlights when on /accountability/* routes",
        "Mobile hamburger menu includes Accountability link",
        "Link accessible via keyboard navigation (Tab key)",
        "Hover state uses existing header styles",
        "Typecheck passes"
      ],
      "priority": 1,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-002",
      "title": "Update credits page to mention investigations",
      "description": "As a user, I want to know credits can be used for investigations too.",
      "acceptanceCriteria": [
        "Update credits page copy to mention 'briefs or investigations'",
        "Each brief or investigation costs 1 credit",
        "No breaking changes to existing credit purchase flow",
        "Mobile layout displays correctly",
        "Typecheck passes"
      ],
      "priority": 2,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-003",
      "title": "Create E2E happy path test",
      "description": "As a developer, I need an E2E test for the full investigation flow.",
      "acceptanceCriteria": [
        "Create test file: tests/e2e/accountability-tracker.spec.ts",
        "Test navigates to /accountability landing page",
        "Test enters target entity and opens ethics modal",
        "Test checks acknowledgment checkbox and proceeds",
        "Test verifies navigation to generation progress page",
        "Test waits for SSE completion events",
        "Test verifies results page renders with profile, scenarios, actions",
        "Test completes in <3 minutes",
        "Typecheck passes"
      ],
      "priority": 3,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-004",
      "title": "Create E2E quality gate failure test",
      "description": "As a developer, I need to verify credit refund on low-quality investigations.",
      "acceptanceCriteria": [
        "Test enters non-existent entity name",
        "Test acknowledges ethics modal",
        "Test waits for generation to complete with error",
        "Test verifies SSE error event with creditRefunded: true",
        "Test verifies error message about insufficient data",
        "Typecheck passes"
      ],
      "priority": 4,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-005",
      "title": "Create E2E PDF export test",
      "description": "As a developer, I need to verify PDF export functionality.",
      "acceptanceCriteria": [
        "Test navigates to completed investigation results page",
        "Test clicks Export PDF button",
        "Test verifies navigation to /accountability/[id]/print route",
        "Test verifies print-optimized layout renders",
        "Test verifies disclaimer watermark present",
        "Test verifies all sections present (profile, scenarios, actions, sources)",
        "Typecheck passes"
      ],
      "priority": 5,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-006",
      "title": "Create regression tests for existing features",
      "description": "As a developer, I need to ensure existing features still work.",
      "acceptanceCriteria": [
        "Create test file: tests/e2e/regression.spec.ts",
        "Test brief generation still works",
        "Test home page renders without console errors",
        "Test explore page renders correctly",
        "Test authentication flow unchanged",
        "Zero TypeScript errors (npm run typecheck)",
        "Typecheck passes"
      ],
      "priority": 6,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-007",
      "title": "Create developer documentation",
      "description": "As a future developer, I want complete documentation for the feature.",
      "acceptanceCriteria": [
        "Create documentation file: docs/ACCOUNTABILITY_TRACKER.md",
        "Section 1: Feature Overview (what it does, ethical considerations)",
        "Section 2: Architecture Diagram (LangGraph flow, data sources, API routes)",
        "Section 3: Database Schema (tables, columns, RLS policies)",
        "Section 4: API Endpoints (request/response formats, rate limits)",
        "Section 5: Agent Prompts (system prompts, model selection)",
        "Section 6: UK Data Sources (Companies House, Tavily setup)",
        "Section 7: Testing Guide (how to run tests)",
        "Section 8: Troubleshooting (common errors, debugging)",
        "Section 9: Deployment (environment variables, checklist)",
        "All links working",
        "Markdown properly formatted"
      ],
      "priority": 7,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-008",
      "title": "Run typecheck and fix any errors",
      "description": "As a developer, I need zero TypeScript errors before deployment.",
      "acceptanceCriteria": [
        "Run npm run typecheck",
        "Fix any TypeScript errors related to accountability tracker",
        "All files compile without errors",
        "Document any pre-existing errors that are unrelated"
      ],
      "priority": 8,
      "passes": false,
      "notes": ""
    }
  ]
}
