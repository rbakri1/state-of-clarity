# Ralph Progress Log
Started: Sat 10 Jan 2026

## Codebase Patterns
- Database types are defined in lib/supabase/client.ts (not a separate types.ts file)
- Browser-safe Supabase client: use lib/supabase/browser.ts (not client.ts) in client components to avoid next/headers import errors
- Use `IF NOT EXISTS` for migrations to make them idempotent
- RLS policies: users can SELECT their own, service_role can manage all
- Credit amounts: positive = purchase/refund/bonus, negative = usage/expiry
- Supabase chained queries cause TypeScript `never` inference issues - use `(supabase as any)` for update/insert operations with helper functions
- Stripe client in lib/stripe/client.ts uses lazy init via getStripe() to avoid build-time errors
- For Supabase select queries, cast result with `as TypeName | null` to fix `never` type inference
- Client components needing auth-protected data should call API routes (not service-role directly)
- Wrap useSearchParams() in Suspense boundary for Next.js static page generation

---

