# Ralph Progress Log
Started: Sun 11 Jan 2026

## Codebase Patterns
- Database types are defined in lib/supabase/client.ts (not a separate types.ts file)
- SQL schema changes go in lib/supabase/schema.sql (single file, not migrations)
- Browser-safe Supabase client: use createBrowserClient from lib/supabase/client.ts in client components
- Use explicit type annotations in React map callbacks to avoid implicit any errors
- Wrap useSearchParams() in Suspense boundary for Next.js static page generation
- API routes go in app/api/ directory, use createServerSupabaseClient from lib/supabase/client.ts
- Components go in app/components/ directory
- Use lucide-react for icons
- Clean .next cache with `rm -rf .next` if build fails with manifest errors
- Supabase TS types may infer `never` for insert/update; use `(supabase as any)` workaround with eslint-disable comment
- For optimistic UI: store previousState before API call, revert if response not ok

---

## 2026-01-11 - US-001
Thread: https://ampcode.com/threads/T-019ba9ab-ecb5-762e-b7e8-f60e0c1f4c72
- Created feedback database schema for community feedback system
- Files changed:
  - lib/supabase/schema.sql - Added 4 new tables: brief_votes, source_suggestions, error_reports, edit_proposals with RLS policies
  - lib/supabase/client.ts - Added TypeScript types for all new tables
  - app/brief/[id]/page.tsx - Fixed implicit any type errors in map callbacks (pre-existing issue)
- **Learnings for future iterations:**
  - Schema uses IF NOT EXISTS for table creation
  - RLS policies for user-created content follow pattern: insert requires auth.uid() = user_id, update uses USING (true) for system access
  - Use explicit type annotations in map callbacks: `(item: any, i: number) =>` or cast objects: `Object.entries(obj as Record<string, number>)`
---

## 2026-01-11 - US-002
Thread: https://ampcode.com/threads/T-019ba9b0-5af0-7029-8c53-4ffc37693cdc
- Created vote API endpoints for brief voting system
- Files changed:
  - app/api/briefs/[id]/vote/route.ts - New file with GET, POST, DELETE handlers
- **Learnings for future iterations:**
  - Next.js 14+ dynamic route params are `Promise<{ id: string }>` - must await them
  - Use `(supabase as any)` for insert/update when Supabase types infer `never`
  - API route handlers use `params: Promise<...>` pattern, not direct object access
---

## 2026-01-11 - US-003
Thread: https://ampcode.com/threads/T-019ba9b5-60e3-775d-ae93-f473f977848b
- Created VoteButtons component with upvote/downvote functionality
- Files changed:
  - app/components/VoteButtons.tsx - New file with interactive vote buttons
- **Learnings for future iterations:**
  - Components go in app/components/ directory (created it for this project)
  - Use createBrowserClient from lib/supabase/client.ts in client components
  - Optimistic UI: store previousState before API call, revert on error
  - Show different UI states: loading, authenticated, unauthenticated
---

